---
title: "NDH802 - Assignment 3"
author: "Group no. "
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
```

------------------------------------------------------------------------

-   The assignment includes 3 questions, 4 points each.
-   Question 1 is purely theoretical (no data). Question 2 and 3 are empirical (based on the data provided).
-   Your submission should be an RMarkdown file with your solutions in words and/or R code. If you handwrite parts of your assignment, insert it as an image near the corresponding question(s). Name the files NDH802_Assignment1_GroupNumber.
-   You should work in groups and contribute equally.
-   You can copy my code, but make sure you understand it.
-   You should not have the exact solutions and/or results with other groups.
-   Results without code/justifications will not be graded.

------------------------------------------------------------------------

### Set things up

Set your working directory

```{r}
#setwd("")
```

Run this code chunk to load data into your R Environment. The command will randomly select 1,000,000 rows of data from the original data set. \textcolor{red}{Fill in your group number within `set.seed()`.} For example, if you are group 3, make it `set.seed(3)`. Hereby each and every group should have a unique `df`. Accordingly, your results should be different from other groups' and you should not be comparing them.\
*Note*. If you make the wrong seed, your assignment will **not** be graded.

```{r}
inference_dataset <- read.csv("https://cda.hhs.se/inference_dataset.csv")
set.seed(1); df <- inference_dataset[sample(1:nrow(inference_dataset),
                           size = 1000000,
                           replace = FALSE), -1]
rm(inference_dataset)
sample_mean = runif(1, 50, 60)
```

Please refer to Canvas, Hand-in 3 for more details about the data set.

\newpage

### Question 1. Sampling theory

The maximum score for the course NDH802 is 70. Suppose you read an (imaginary) report that says the scores are normally distributed with the standard deviation of 12. Unfortunately, the population (so-called the *true*) mean score is not readable.

(a) You talk to a random sample of 36 students from previous years and their scores are recorded in the following `sample`. Please fill in your group number and run the whole following code chunk to see the scores.

    ```{r, echo=FALSE}
    #please fill in your group number in set.seed()
    set.seed(8); sample = round(rnorm(36, 55, 12),0)
    cat(sample)
    ```

    Find the 90% confidence interval for the population mean score (0.5p). How would you interpret the 90% confidence interval, in general and in this case? (0.5p)

(b) Assume that you want to increase the confidence level to 99%, but you do not want the confidence interval to be longer. What would you do? Please illustrate your answer with empirical evidence(s). For example, if you propose to decrease or increase something, also indicate why and by/to how much. (1p)

    ```{r}
    sigma = 12
    n = 36
    x_bar = mean(sample)

    ucl = x_bar + 1.645*sigma/sqrt(n)
    lcl = x_bar - 1.645*sigma/sqrt(n)

    ((2.58*sigma)/(ucl-x_bar))^2
    ```

### Question 2. Hypothesis testing

(a) Imagine you are the customer relationship manager. One of your colleagues argues that **the average `value` of the customers is 4150**. Do you reject this claim at 95% confidence level based on your sample data (i.e., `df`)? Justify your answer. (1p)
(b) Now you want to investigate only the customers who return more than 30 items. Your colleague argues that **their average `value` is less than 40000**. Do you reject this claim at 95% confidence level based on your sample data (i.e., `df`)? Justify your answer. (1p)
(c) Consider these two groups of customers:

-   Group 1: Loyal customers whose points are lower than 6500
-   Group 2: Not loyal customers whose points are higher than 1000

Which group is more valuable (based on their `value`)?\
Perform the test at 99% confidence level (1p) and justify your choice (1p).

### Question 3. Correlation and regression

(a) Your objective for 2021 is to increase the customer `value`. In order to do that, you first aim to understand which factors (variables) are the most influential. Write your own linear regression equation (modify the one below), perform the estimation, print out the model estimation. $$ value = \beta_0 + \beta_1var_1 + \ldots + \beta_nvar_n + \epsilon $$ You are free to include any variables in `df` (other than `channeltype`) as your dependent variables. (1p)

(b) You need to explain the results from (a) to your boss who has not taken the course "Data analytics". How would you do that? (1p)

(c) Imagine you have three new customers:

```{r, echo=FALSE}
read.csv("https://bit.ly/30tIXfp")[,-1]
```

Based on your linear regression model, which customer (choose one) do you think is the most valuable? Justify your choice. (1p)

(d) Looking at the figure below, your colleague suggests that you should give the customers more `points` to increase their `value`. What do you think? (1p)

```{r, echo=FALSE, fig.align='center', out.width="70%"}
set.seed(802); toplot = df[sample(1:nrow(df), size = 100, replace = FALSE),]
plot(toplot$points, toplot$value, col = "dimgray",
     xlim = c(0, 25000), ylim = c(0, 25000),
     xlab = "points", ylab = "value")
```

*Note*: For illustration purpose, the plot only includes 100 customers. One little circle represents one customer.

\vfill

*Have fun and good luck!*\
*Huong and Emelie*
